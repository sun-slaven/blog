---
title: NAT、内网IP/外网IP
tags:
  - NAT
categories:
  - 计算机网络
date: 2017-02-19 13:35:15
---
NAT（Network Address Translation，网络地址转换）是1994年提出的。当在专用网内部的一些主机本来已经分配到了本地IP地址（即仅在本专用网内使用的专用地址），但现在又想和因特网上的主机通信（并不需要加密）时，可使用NAT方法。

这种方法需要在专用网连接到因特网的路由器上安装NAT软件。装有NAT软件的路由器叫做NAT路由器，它至少有一个有效的外部全球IP地址。这样，所有使用本地地址的主机在和外界通信时，都要在NAT路由器上将其本地地址转换成全球IP地址，才能和因特网连接。

另外，这种通过使用少量的公有IP 地址代表较多的私有IP 地址的方式，将有助于减缓可用的IP地址空间的枯竭.

NAT不仅能解决了lP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。
1. 宽带分享：这是 NAT 主机的最大功能。
2. 安全防护：NAT 之内的 PC 联机到 Internet 上面时，他所显示的 IP 是 NAT 主机的公共 IP，所以 Client 端的 PC 当然就具有一定程度的安全了，外界在进行 portscan（端口扫描） 的时候，就侦测不到源Client 端的 PC

NAT的实现方式有三种，即静态转换Static Nat、动态转换Dynamic Nat和端口多路复用OverLoad。

静态转换是指将内部网络的私有IP地址转换为公有IP地址，IP地址对是一对一的，是一成不变的，某个私有IP地址只转换为某个公有IP地址。借助于静态转换，可以实现外部网络对内部网络中某些特定设备（如服务器）的访问。

动态转换是指将内部网络的私有IP地址转换为公用IP地址时，IP地址是不确定的，是随机的，所有被授权访问上Internet的私有IP地址可随机转换为任何指定的合法IP地址。也就是说，只要指定哪些内部地址可以进行转换，以及用哪些合法地址作为外部地址时，就可以进行动态转换。动态转换可以使用多个合法外部地址集。当ISP提供的合法IP地址略少于网络内部的计算机数量时。可以采用动态转换的方式。

端口多路复用（Port address Translation,PAT)是指改变外出数据包的源端口并进行端口转换，即端口地址转换（PAT，Port Address Translation).采用端口多路复用方式。内部网络的所有主机均可共享一个合法外部IP地址实现对Internet的访问，从而可以最大限度地节约IP地址资源。同时，又可隐藏网络内部的所有主机，有效避免来自internet的攻击。因此，目前网络中应用最多的就是端口多路复用方式。

路由以里的叫内网,内网则是一定范围内的局域网，企业网、校园网、家庭网。
路由以外的叫外网。

内网IP呢 就是你自己分配给机器的 “身份证”，这个身份证只在你家有效。 出门人家不认。

外网IP呢 就是INTERNET国际互联网分配给你的 “身份证”，这个证件全球唯一任何地方有效。
在内网对路由器以外的访问 都需要将内网地址转换成外网地址(NAT)进行传输。

从外部访问，是找到你外网IP传到你的路由上 。然后 由你路由负责转发到内部地址上。

在以下范围内的都是内网IP，路由器若碰到内网IP直接丢弃。：
```
10.0.0.0-10.255.255.255
172.16.0.0-172.31.255.255
192.168.0.0-192.168.255.255
```
通过ifconfig查看的ip地址都是内网IP。

NAT转换表存储于网关上。
NAT地址转换表：
192.168.0.3和192.168.0.7为内网本地地址；
172.38.1.5和172.38.1.6均为NAT路由器的公网IP地址.
出和入一一对应

| 方向 | 字段 | 旧的IP地址 | 新的IP地址 |
|:-----:|:---:|:----------:|:----------:|
|出| 源IP地址 |192.168.0.3| 172.38.1.5 |
|入| 目的IP地址 |172.38.1.5| 192.168.0.3 |
|出| 源IP地址 |192.168.0.7|172.38.1.6|
|入| 目的IP地址 |172.38.1.6| 192.168.0.7 |
